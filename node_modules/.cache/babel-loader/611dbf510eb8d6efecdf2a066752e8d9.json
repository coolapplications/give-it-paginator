{"ast":null,"code":"import _slicedToArray from \"/home/estudiantes/amauricio.alvarez/Desktop/give-it/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/estudiantes/amauricio.alvarez/Desktop/give-it/src/react-auth0-spa.tsx\";\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\nimport React, { useContext, useEffect, useState } from \"react\";\n\nconst DEFAULT_REDIRECT_CALLBACK = () => window.history.replaceState({}, document.title, window.location.pathname);\n\nexport const Auth0Context = React.createContext(null);\nexport const useAuth0 = () => useContext(Auth0Context);\nexport function Auth0Provider({\n  children,\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\n  initOptions\n}) {\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        isAuthenticated = _useState2[0],\n        setIsAuthenticated = _useState2[1];\n\n  const _useState3 = useState(),\n        _useState4 = _slicedToArray(_useState3, 2),\n        user = _useState4[0],\n        setUser = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        auth0Client = _useState6[0],\n        setAuth0 = _useState6[1];\n\n  const _useState7 = useState(true),\n        _useState8 = _slicedToArray(_useState7, 2),\n        isLoading = _useState8[0],\n        setIsLoading = _useState8[1];\n\n  const _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        isPopupOpen = _useState10[0],\n        setIsPopupOpen = _useState10[1];\n\n  useEffect(() => {\n    const initAuth0 = async () => {\n      const auth0FromHook = await createAuth0Client(initOptions);\n      setAuth0(auth0FromHook);\n\n      if (window.location.search.includes(\"code=\") && window.location.search.includes(\"state=\")) {\n        const _ref = await auth0FromHook.handleRedirectCallback(),\n              appState = _ref.appState;\n\n        onRedirectCallback(appState);\n      }\n\n      const isAuthenticated = await auth0FromHook.isAuthenticated();\n      setIsAuthenticated(isAuthenticated);\n\n      if (isAuthenticated) {\n        const user = await auth0FromHook.getUser();\n        setUser(user);\n      }\n\n      setIsLoading(false);\n    };\n\n    initAuth0(); // eslint-disable-next-line\n  }, []);\n\n  const loginWithPopup = async (params = {}) => {\n    setIsPopupOpen(true);\n\n    try {\n      await auth0Client.loginWithPopup(params);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setIsPopupOpen(false);\n    }\n\n    const user = await auth0Client.getUser();\n    setUser(user);\n    setIsAuthenticated(true);\n  };\n\n  const handleRedirectCallback = async () => {\n    setIsLoading(true);\n    await auth0Client.handleRedirectCallback();\n    const user = await auth0Client.getUser();\n    setIsLoading(false);\n    setIsAuthenticated(true);\n    setUser(user);\n  };\n\n  const getIdTokenClaims = options => auth0Client.getIdTokenClaims(options);\n\n  const loginWithRedirect = options => auth0Client.loginWithRedirect(options);\n\n  const getTokenSilently = options => auth0Client.getTokenSilently(options);\n\n  const getTokenWithPopup = options => auth0Client.getTokenWithPopup(options);\n\n  const logout = options => auth0Client.logout(options);\n\n  return React.createElement(Auth0Context.Provider, {\n    value: {\n      user,\n      isAuthenticated,\n      isLoading,\n      isPopupOpen,\n      loginWithPopup,\n      handleRedirectCallback,\n      getIdTokenClaims,\n      loginWithRedirect,\n      getTokenSilently,\n      getTokenWithPopup,\n      logout\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, children);\n}","map":{"version":3,"sources":["/home/estudiantes/amauricio.alvarez/Desktop/give-it/src/react-auth0-spa.tsx"],"names":["createAuth0Client","React","useContext","useEffect","useState","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","Auth0Context","createContext","useAuth0","Auth0Provider","children","onRedirectCallback","initOptions","isAuthenticated","setIsAuthenticated","user","setUser","auth0Client","setAuth0","isLoading","setIsLoading","isPopupOpen","setIsPopupOpen","initAuth0","auth0FromHook","search","includes","handleRedirectCallback","appState","getUser","loginWithPopup","params","error","console","getIdTokenClaims","options","loginWithRedirect","getTokenSilently","getTokenWithPopup","logout"],"mappings":"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","sourcesContent":["import createAuth0Client from \"@auth0/auth0-spa-js\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\n\r\nexport interface Auth0RedirectState {\r\n  targetUrl?: string;\r\n}\r\n\r\nexport interface Auth0User extends Omit<IdToken, \"__raw\"> {}\r\n\r\ninterface Auth0Context {\r\n  user?: Auth0User;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  isPopupOpen: boolean;\r\n  loginWithPopup(o?: PopupLoginOptions): Promise<void>;\r\n  handleRedirectCallback(): Promise<void>;\r\n  getIdTokenClaims(o?: getIdTokenClaimsOptions): Promise<IdToken>;\r\n  loginWithRedirect(o?: RedirectLoginOptions): Promise<void>;\r\n  getTokenSilently(o?: GetTokenSilentlyOptions): Promise<string | undefined>;\r\n  getTokenWithPopup(o?: GetTokenWithPopupOptions): Promise<string | undefined>;\r\n  logout(o?: LogoutOptions): void;\r\n}\r\ninterface Auth0ProviderOptions {\r\n  children: React.ReactElement;\r\n  onRedirectCallback(result: RedirectLoginResult): void;\r\n  initOptions: Auth0ClientOptions;\r\n}\r\n\r\nconst DEFAULT_REDIRECT_CALLBACK = () =>\r\n  window.history.replaceState({}, document.title, window.location.pathname);\r\n\r\nexport const Auth0Context = React.createContext<Auth0Context | null>(null);\r\nexport const useAuth0 = () => useContext(Auth0Context);\r\nexport function Auth0Provider({\r\n  children,\r\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\r\n  initOptions\r\n}: Auth0ProviderOptions) {\r\n  const [isAuthenticated, setIsAuthenticated] = useState();\r\n  const [user, setUser] = useState();\r\n  const [auth0Client, setAuth0] = useState();\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isPopupOpen, setIsPopupOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const initAuth0 = async () => {\r\n      const auth0FromHook = await createAuth0Client(initOptions);\r\n      setAuth0(auth0FromHook);\r\n\r\n      if (\r\n        window.location.search.includes(\"code=\") &&\r\n        window.location.search.includes(\"state=\")\r\n      ) {\r\n        const { appState } = await auth0FromHook.handleRedirectCallback();\r\n        onRedirectCallback(appState);\r\n      }\r\n\r\n      const isAuthenticated = await auth0FromHook.isAuthenticated();\r\n\r\n      setIsAuthenticated(isAuthenticated);\r\n\r\n      if (isAuthenticated) {\r\n        const user = await auth0FromHook.getUser();\r\n        setUser(user);\r\n      }\r\n\r\n      setIsLoading(false);\r\n    };\r\n    initAuth0();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const loginWithPopup = async (params = {}) => {\r\n    setIsPopupOpen(true);\r\n    try {\r\n      await auth0Client.loginWithPopup(params);\r\n    } catch (error) {\r\n      console.error(error);\r\n    } finally {\r\n      setIsPopupOpen(false);\r\n    }\r\n    const user = await auth0Client.getUser();\r\n    setUser(user);\r\n    setIsAuthenticated(true);\r\n  };\r\n\r\n  const handleRedirectCallback = async () => {\r\n    setIsLoading(true);\r\n    await auth0Client.handleRedirectCallback();\r\n    const user = await auth0Client.getUser();\r\n    setIsLoading(false);\r\n    setIsAuthenticated(true);\r\n    setUser(user);\r\n  };\r\n\r\n  const getIdTokenClaims = (options?: getIdTokenClaimsOptions) =>\r\n    auth0Client.getIdTokenClaims(options);\r\n\r\n  const loginWithRedirect = (options?: RedirectLoginOptions) =>\r\n    auth0Client.loginWithRedirect(options);\r\n\r\n  const getTokenSilently = (options?: GetTokenSilentlyOptions) =>\r\n    auth0Client.getTokenSilently(options);\r\n\r\n  const getTokenWithPopup = (options?: GetTokenWithPopupOptions) =>\r\n    auth0Client.getTokenWithPopup(options);\r\n\r\n  const logout = (options?: LogoutOptions) => auth0Client.logout(options);\r\n\r\n  return (\r\n    <Auth0Context.Provider\r\n      value={{\r\n        user,\r\n        isAuthenticated,\r\n        isLoading,\r\n        isPopupOpen,\r\n        loginWithPopup,\r\n        handleRedirectCallback,\r\n        getIdTokenClaims,\r\n        loginWithRedirect,\r\n        getTokenSilently,\r\n        getTokenWithPopup,\r\n        logout\r\n      }}\r\n    >\r\n      {children}\r\n    </Auth0Context.Provider>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}